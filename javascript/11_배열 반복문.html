<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>11_배열 반복문.html</title>
    <link rel="stylesheet" href="./styles/style11.css">
    <script src="https://kit.fontawesome.com/5ae185438f.js" crossorigin="anonymous"></script>
</head>
<body>
    
    <h3># 배열을 멋있게 다루기</h3>

    <h3>(1) 모든 학생 기본정보 테이블</h3>
    <div id="all_table"></div>

    <h3>(2) 평균 점수 추가된 테이블</h3>
    <div id="avg_table"></div>

    <h3>(3) 수학 보충 수업 받아야하는 학생들</h3>
    <div id="math_failed_table"></div>

    <h3>(4) 평균 만족도</h3>
    <div id="star_table"></div>
    
    <script>
        const arr = [1, 2, 3, 4, 5, 6];

        // 배열.forEach() : 배열의 모든 값을 활용해 전달한 함수를 실행한다

        // 전달한 콜백함수의 첫 번재 인자로 값이 도착하고
        // 두 번째 인자로 인덱스 값이 도착하고
        // 세 번째 인자로 원본 배열이 도착한다
        arr.forEach((value, index, ori) => {
            console.log(`arr[${index}]=${value}입니다.`);
        });

        const scores = [90, 88, 70, 95, 35, 60];

        scores.forEach((score, i) => {
            console.log(`${i}번째 학생의 점수: ${score}`);
        });

        // 배열.map() : 배열의 모든 값으로 전달한 함수를 실행한 반환값들로 이루어진
        //              새로운 배열을 생성하여 반환한다
        const scoreAndGrades = scores.map(score => {
            let grade;
            if (score < 0 || score > 100) {
                grade = 'F';
            } else if (score >= 90) {
                grade = 'A';
            } else if (score >= 80) {
                grade = 'B';
            } else if (score >= 70) {
                grade = 'C';
            } else if (score >= 60) {
                grade = 'D';
            } else {
                grade = 'F';
            }

            return {
                "score": score,
                "grade": grade
            };
        });

        console.log(scoreAndGrades);

        // 연습: 다음 배열을 활용하여 새로운 평균 점수 배열을 생성해보세요
        const students = [
            {
                name: '유재석',
                kor: 90,
                eng: 80,
                math: 70
            }, 
            {
                name: '일론 머스크',
                kor: 10,
                eng: 90,
                math: 100
            }, 
            {
                name: '마이클 타이슨',
                kor: 30,
                eng: 33,
                math: 13
            }
        ];

        const getAvg = stu => 
            Math.round((stu.kor + stu.eng + stu.math) / 3 * 100) / 100;
        
        // 화살표 함수에서 객체를 리턴하고 싶은 경우 
        // {}가 함수의 body가 아니게 되도록 ()로 한번 감싸줘야 한다
        const studentAvgs = students.map(student => ({
            ...student,
            avg: getAvg(student),
        }));

        console.log(studentAvgs);


        // 배열.filter() : 전달한 함수를 돌린 결과가 true인 값만 남긴 배열을 생성

        // e.g. 평균 점수가 60점 이상인 학생만 남기고 싶다
        const passedStudents = studentAvgs.filter(stu => stu.avg >= 60);
        console.log(passedStudents);

        const snacks = ['초코하임', '초코파이', '누네띠네', '스윙칩', '포테토칩', '민트초코하임', '민트초코송이'];

        // e.g. 칩으로 끝나는 과자만 남기기
        const chips = snacks.filter(s => s.endsWith('칩'));
        console.log(chips);

        // e.g. 초코가 포함된 과자만 남기기
        const chocosnacks = snacks.filter(s => s.includes('초코'));
        console.log(chocosnacks);

        // 배열.reduce() : 배열의 모든 값을 사용해 하나의 결과를 내는 함수
        const prices = [1500, 2000, 2300, 800, ];

        // e.g. reduce()를 사용해 총합을 구하는 경우
        let result = prices.reduce((prev, curr, index, arr) => {
            console.log('prev: ', prev);
            console.log('curr:', curr);
            console.log('index:', index);
            console.log('전체배열:' , arr);
            console.log('------------------------');

            // 여기서 리턴하는 값이 다음 반복의 prev값이 된다
            return prev + curr;
        });
        console.log('결과:', result);

        // e.g. 가장 작은 값을 구하기
        let smallest = prices.reduce((acc, curr) => Math.min(acc, curr));
        console.log('가장 작은 값: ', smallest);

        // e.g. 가장 큰 값을 구하기
        const biggest = prices.reduce((acc, curr) => Math.max(acc, curr));
        console.log('가장 큰 값: ', biggest);

        console.log(Math.max(...prices));


        /*
            (1) 학생 번호, 이름, 국/영/수 랜덤 점수, 급식 만족도(별 0 ~ 5)를 가진
                학생 100명의 자바스크립트 오브젝트 배열을 생성
            (2) 모든 학생들의 평균 점수들로 이루어진 배열을 생성
            (3) 수학 점수가 60점 이하인 학생들로만 이루어진 배열을 생성
            (4) 학생들의 급식 만족도의 평균을 구할 것

            (1) ,(2), (3)을 모두 html에 보기좋게 출력할 것
        */

        // (1) 학생 번호, 이름, 국/영/수 랜덤 점수, 급식 만족도(별 0 ~ 5)를 가진
        //     학생 100명의 자바스크립트 오브젝트 배열을 생성
        const all_student = [];
        
        const lastNames = ['김', '이', '박', '최'];
        const firstNames = ['재석', '호동', '희철', '민규'];

        const getRandomValue = arr => arr[Math.floor(Math.random() * arr.length)];
        const getRandomName = () => getRandomValue(lastNames) + getRandomValue(firstNames);
        const getRandomScore = () => Math.floor(Math.random() * 101);
        const getRandomStar = () => Math.floor(Math.random() * 6);

        const genRandomStudent = () => ({
            name: getRandomName(),
            kor: getRandomScore(),
            eng: getRandomScore(),
            math: getRandomScore(),
            star: getRandomStar(),
        });
        for (let i = 0; i < 100; ++i) {
            all_student.push(genRandomStudent());
        }

        console.log(all_student);

        //2.
        // // const getAvg = stu => 
        // //     Math.round((stu.kor + stu.eng + stu.math) / 3 * 100) / 100;
        const all_students_avg = all_student.map(stu => ({
            ...stu,
            avg: getAvg(stu)
        }));
        console.log(all_students_avg);

        //3.
        const math_failed_students = all_student.filter(stu => stu.math <= 60);
        console.log(math_failed_students);

        //4.
        // 학생 객체들로 이루어진 배열에 reduce()를 사용하여 총합을 구하기 위해서는
        // 초기의 prev 같이 0이 되어야 한다
        // reduce(callbackfn, initialValue)
        const avg_star = all_student.reduce( (sum, stu) => sum + stu.star, 0 ) / all_student.length;
        console.log(avg_star);


        // html 출력
        const addColumnHeader = (table, columnName) => 
            table.innerHTML += `<div class="column-header">${columnName}</div>`;

        const addLine = (table, stu) => {
            for (key in stu) {
                table.innerHTML += `<div class="table-data">${stu[key]}</div>`;
            }
            
        };
        const addData = (tableName, data) => {
            const table = document.getElementById(tableName);

            table.style.display = "grid";

            let size = 0;
            for(key in data[0]) {
                addColumnHeader(table, key);
                ++size;
            }
            table.style.gridTemplateColumns = `repeat(${size}, 1fr)`;

            data.forEach(stu => addLine(table, stu));
        };
        
         addData("all_table", all_student);
         addData("avg_table", all_students_avg);
        
         


         
        // const allStudent = [];
        // const stuNameArr = ['철수', '영희', '상철', '병철', '수희', '예지', '가현', '나현', '병규'];

        // for (let i = 0; i < 100; ++i) {
        //     allStudent[i] = {
        //         stuNum : i,
        //         name: stuNameArr[parseInt(Math.random() * stuNameArr.length)],
        //         kor: parseInt(Math.random() * 101),
        //         eng: parseInt(Math.random() * 101),
        //         math: parseInt(Math.random() * 101),
        //         mealSati: parseInt(Math.random() * 6),
        //     };
        // }

        // // const getAvg = stu => 
        // //     Math.round((stu.kor + stu.eng + stu.math) / 3 * 100) / 100;
        // //(2)
        // const eachStuAvg = allStudent.map(stu => Math.round((stu.kor + stu.eng + stu.math) / 3 * 100) / 100);

        // console.log('각학생의 평균:', eachStuAvg);

        // // (3)
        // const mathPassedStu = allStudent.filter(stu => stu.math >= 60);
        // console.log('수학통과:',mathPassedStu);

        // //(4)
        // const allMealScore = allStudent.map(value => value.mealSati);
        // console.log('모든평점들', allMealScore);
        // result = allMealScore.reduce((prev, curr) => (prev + curr));
        // result = result / 100;
        // console.log('급식만족도 평균:', result);


       

        // const allStuInfo = document.getElementById('all-stu');
        // const passMathStuInfo = document.getElementById("pass-math-stu");
        // const mealGrade = document.getElementsByClassName("each-stu-sati");

        // allStudent.forEach(value => {
        //     allStuInfo.innerHTML += 
        //     `<div class="each-student">
        //         <div class="each-stu-num">학번:${value.stuNum}</div>
        //         <div class="each-stu-name">이름:${value.name}</div>
        //         <div class="each-stu-score">국어:${value.kor}, 수학:${value.math}, 영어:${value.eng}</div>
        //         <div class="each-stu-avg">평균: ${eachStuAvg[value.stuNum]}</div>
        //         <div class="each-stu-sati">급식만족도: </div>
        //     </div>`;
        //     let count = value.mealSati;
        //     let blank = 5- value.mealSati;
        //     while (count != 0) {
        //         mealGrade[value.stuNum].innerHTML += `<i class="fa-solid fa-star"></i>`;
        //         --count;
        //     }
        //     while(blank != 0) {
        //         mealGrade[value.stuNum].innerHTML += `<i class="fa-regular fa-star"></i>`;
        //         --blank;
        //     }
        // });

        // mathPassedStu.forEach(value => {
        //     passMathStuInfo.innerHTML += 
        //     `<div class="each-student">
        //         <div class="each-stu-num">학번:${value.stuNum}</div>
        //         <div class="each-stu-name">이름:${value.name}</div>
        //         <div class="each-stu-score">국어:${value.kor}, 수학:${value.math}, 영어:${value.eng}</div>
        //         <div class="each-stu-avg">평균: ${eachStuAvg[value.stuNum]}</div>
        //         <div class="each-stu-sati">급식만족도: </div>
        //     </div>`;
            
           
        // });

       



        
    </script>


</body>
</html>